apiVersion: v1
kind: Pod
metadata:
  name: training--yjx
  namespace: zauto
spec:
  nodeName: node1
  containers:
    - name: yjx-test
      image: registry.cn-hangzhou.aliyuncs.com/treasures/training-script-env:v0.0.2  # update
      imagePullPolicy: IfNotPresent
      command:
        - "python"
        - "/training_script/image_classification_training_script/run_image_classification.py"
        - "--model_name_or_path=/treasures/model"
        - "--train_dir=/treasures/data"
        - "--output_dir=/treasures/output"
        - "--remove_unused_columns=False"
        - "--do_train"
        - "--do_eval"
        - "--learning_rate=2e-5"
        - "--num_train_epochs=5"
        - "--per_device_train_batch_size=8"
        - "--per_device_eval_batch_size=8"
        - "--logging_strategy=steps"
        - "--logging_steps=10"
        - "--evaluation_strategy=epoch"
        - "--save_strategy=epoch"
        - "--load_best_model_at_end=False"
        - "--save_total_limit=3"
        - "--seed=1337"
        - "--ignore_mismatched_sizes=True"
        - "--overwrite_output_dir=True"
      env:
        - name: "TRANSFORMERS_OFFLINE"
          value: "1"
        - name: "HF_DATASETS_OFFLINE"
          value: "1"
      resources:
        limits:
          memory: "1Gi"
          cpu: "0.5"
      volumeMounts:
        - name: data-dir
          mountPath: /treasures/data
        - name: model-dir
          mountPath: /treasures/model
        - name: output-dir
          mountPath: /treasures/output
  volumes:
    - name: data-dir
      hostPath:
        path: /root/workspace/YJX/auto-ml/volume/data  # update
    - name: model-dir
      hostPath:
        path: /root/workspace/YJX/auto-ml/volume/model # update
    - name: output-dir
      hostPath:
        path: /root/workspace/YJX/auto-ml/volume/output  # update
